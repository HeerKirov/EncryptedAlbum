<div id="mainView" class="container-fluid" v-if="visible">
    <nav id="navBar" class="navbar navbar-expand-sm fixed-top" style="height: 50px" :style="{'top': fullscreen ? '0' : '22px'}">
        <div class="ml-2" style="position: fixed; left: 0;">
            <button type="button" class="btn btn-sm btn-success" @click="add"><i class="fa fa-plus"></i></button>
        </div>
        <div class="mr-2" style="position: absolute; left: 42px">
          <button type="button" class="btn btn-sm" :class="{'btn-outline-secondary': !selected.mode, 'btn-secondary': selected.mode}" @click="switchSelectMode">
            <i class="fa fa-check-square-o"></i>
          </button>
        </div>
        <div style="position: absolute; left: 78px" v-if="viewFolder === 'list'">
            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-outline-secondary" @click="loadOptionToSort" data-toggle="modal" data-target="#sortModal">
                <i class="fa fa-sort-amount-desc"></i>
              </button>
              <button type="button" class="btn btn-sm btn-outline-secondary" @click="loadOptionToFilter" data-toggle="modal" data-target="#filterModal">
                <i class="fa fa-filter"></i>
              </button>
              <input type="text" class="form-control rounded-0" v-model="searchTextInput" @keydown.enter="saveOptionFromSearch" style="width: 312px; height: 31px;">
              <button type="button" class="btn btn-sm btn-secondary" @click="saveOptionFromSearch"><i class="fa fa-search"></i></button>
            </div>
        </div>

        <div class="mr-2" style="position: absolute; right: 71px;">
          <div class="btn-group">
            <button type="button" class="btn btn-sm" :class="{'btn-secondary': viewFolder === 'list', 'btn-outline-secondary': viewFolder !== 'list'}" @click="switchList('list')">
              <div class="d-none d-md-block"><i class="fa fa-list"></i> 阅览列表</div>
              <div class="d-md-none"><i class="fa fa-list"></i></div>
            </button>
            <button type="button" class="btn btn-sm" :class="{'btn-secondary': viewFolder === 'temp', 'btn-outline-secondary': viewFolder !== 'temp'}" @click="switchList('temp')">
              <div class="d-none d-md-block"><i class="fa fa-folder-o"></i> 临时文件夹</div>
              <div class="d-md-none"><i class="fa fa-folder-o"></i></div>
            </button>
          </div>
        </div>
        <div class="mr-2" style="position: absolute; right: 35px">
          <button type="button" class="btn btn-sm btn-outline-secondary" @click="loadOptionToView" data-toggle="modal" data-target="#viewModal"><i class="fa fa-eye"></i></button>
        </div>
        <div class="mr-2" style="position: absolute; right: 0">
          <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fa fa-cog"></i></button>
        </div>
    </nav>

    <div class="modal fade" id="viewModal">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">视图</h5>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="form-check">
              <label class="form-check-label">
                <input v-model="viewInput.aggregateByCollection" type="checkbox" class="form-check-input" value="">按照画集聚合显示
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input v-model="viewInput.showTitle" type="checkbox" class="form-check-input" value="">显示标题
              </label>
            </div>
            <div class="row">
              <div class="col">
                <input v-model="viewInput.zoom" type="range" class="custom-range" min="1" max="10" step="1" value="5" style="height: 25px">
              </div>
              <div class="col-auto">
                <label>图片缩放</label>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal" @click="saveOptionFromView">确定</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="sortModal">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">排序选项</h5>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="radio">
              <label><input type="radio" name="sortRadio" v-model="sortInput.by" value="title">按标题排序</label>
            </div>
            <div class="radio">
              <label><input type="radio" name="sortRadio" v-model="sortInput.by" value="createTime">按创建时间排序</label>
            </div>
            <div class="radio">
              <label><input type="radio" name="sortRadio" v-model="sortInput.by" value="resolution">按大小排序</label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input v-model="sortInput.desc" type="checkbox" class="form-check-input" value="">降序
              </label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal" @click="saveOptionFromSort">确定</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="filterModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">筛选选项</h5>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-auto"><label>收藏夹</label></div>
              <div class="col"><input v-model="filterInput.favorite" type="checkbox" class="form-check-input" value=""></div>
            </div>
            <div class="row">
              <!-- TODO 处理标签组及其绑定 -->
              <div class="col">标签组</div>
              <div class="col">/*TODO*/</div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal" @click="saveOptionFromFilter">确定</button>
          </div>
        </div>
      </div>
    </div>

    <div style="margin-top: 55px; margin-bottom: 55px;">
      <ul style="margin: 0; padding: 0">
        <li v-for="(image, index) in showList" style="display: inline-block;" :style="{width: 60 + view.zoom * 40 + 'px'}">
          <div class="card" style="margin: 2px">
              <img class="card-img-top" :src="image.buffer" alt="Card image" style="width:100%" @click="selectOne(index)">
              <div class="" v-if="view.showTitle">
                  <h6 class="m-2">{{image.title}}</h6>
              </div>
              <i v-if="image.selected" style="position: absolute; right: 5px; bottom: 5px;" class="fa fa-check-circle fa-2x text-primary"></i>
              <i v-if="image.col" style="position: absolute; right: 5px; top: 5px;" class="fa fa-th-list fa-lg text-white"></i>
          </div>
        </li>
      </ul>
    </div>

    <div v-if="selected.mode" style="margin: auto; position: fixed; left:0; bottom:0; width: 620px;">
      <div class="card m-1 p-1">
        <div class="row">
          <div class="col">
            已选择<span class="badge badge-light">{{selected.count}}</span>项
          </div>
          <div class="col-auto">
            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-outline-secondary" @click="selectAll">全选</button>
              <button type="button" class="btn btn-sm btn-outline-secondary" @click="selectNot">反选</button>
            </div>
          </div>
          <div class="col-auto">
            <div class="btn-group btn-group-sm">
              <button type="button" class="btn btn-sm btn-primary" :class="{disabled: !leastSelectOne}" v-if="viewFolder === 'list'" @click="selectAddToTemp">添加到临时文件夹</button>
              <button type="button" class="btn btn-sm btn-primary" :class="{disabled: !leastSelectOne}" v-if="viewFolder === 'temp'" @click="selectRemoveFromTemp">移出临时文件夹</button>
              <div class="btn-group">
                <button type="button" class="btn btn-sm btn-primary dropdown-toggle" :class="{disabled: !leastSelectOne}" data-toggle="dropdown">更多</button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="#">批量修改</a>
                  <a class="dropdown-item" href="#">批量删除</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>